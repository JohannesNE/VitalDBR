---
title: "Heartbeat from Art"
author: "Georg"
date: "4/6/2022"
output: pdf_document
---

Importing VitalDBR
```{r}
library(devtools)
install_github('legendenomgeorg/VitalDBR/VitalDBR')
library(VitalDBR)
library(waveformtools)
```

Loading in data
```{r}
df <- load_case('SNUADC/ART', 1)
```

```{r}
df
```
```{r}
start <- 2000000
sek <- 30
freq <- 1/0.002
sub <- df[start:(start+(sek*freq)),]
sub <- filter_signal(sub,30,2,500)
sub
```


```{r}

plot(sub$Time,sub$SNUADC.ART_filt, type='l')
```


```{r}
beats <- find_abp_beats(sub,3)
```
```{r}
systolic <- beats$time_systole
diastolic <- beats$time
plot(sub$Time, sub$SNUADC.ART, type='l')
for (x in systolic){
  abline(v=x,col="blue")
  
}
for (x in diastolic){
  abline(v=x,col="red")
  
}
```

